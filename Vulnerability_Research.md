# Vulnerability Research

## Introduction to Vulnerability 

A vulnerability in cybersecurity is defined as a weakness or flaw in the design, implementation or behaviours of a system or application. An attacker can exploit these weakness to gain access to un authorised information or perform unauthorised actions. The term "Vulnerability" has many definitions by cyber security bodies. However, there is minimal variation between them all.

For exaple NIST defines a vulnerability as "Weakness in an information system, system security procedures, internal controls, or implementation that could be exploited or triggered by a threat source"

Vulnerability can originate from many factors, including a poor design of an application or an oversight of the intended actions from a user. 

We will come on to discuss the various types of vulnerabilities in a later room. However, for now, we should know that there are arguably five main categories of vulnerabilities 

![image](https://user-images.githubusercontent.com/79100627/173856112-fe524556-490a-4724-9d5f-5ee07139b3bd.png)

## Scoring Vulenrabilities (CVSS & VPR) 

Vulnerability management is the process of evaluating, categorising and ultimately remediating threats (vulnerabilities) faced by an organization. It is arguably impossible to patch and remedy every single vulnerability in a network or computer system and sometimes a waste of resources. 

After all, only approximately 2% of vulnerabilities only ever end up being exploited (Kenna security, 2020). Instead, it is all about addressing the most dangerous vulnerabilities and reducing the likelihood of an attack vector being used to exploit a system.

This is where vulnerability scoring comes into play. Vulnerability scoring serves a vital role in vulnerability management and is used to determine the potential risk and impact a vulnerability may have on a network or computer system. For example, the popular Common Vulnerability Scoring System (CVSS) awards points to a vulnerability based upon its features, availability, and reproducibility.

Of course, as always in the world of IT, there is never just one framework or proposed idea. Let's explore two of the more common frameworks and analyse how they differ.

## Common Vulnerability Scoring System

First introduced in 2005, the Common vulnerability Scoring system (or CVSS) is very popular framework for vulnerability scoring and has three major iterations. As it stands, the current version is CVSSv3.1 (with version 4.0 currently in draft) a score is essentially determined by some of following factors

1. How easy is it to exploit the vulnerability?
2. Do exploits exist for this?
3. How does this vulnerability interfere with the CIA triad?

![image](https://user-images.githubusercontent.com/79100627/173858056-efbc967a-92bc-45a6-90fe-b5f6e2315f1a.png)

However CVSS is not a magic bullet. 

![image](https://user-images.githubusercontent.com/79100627/173858206-2f888694-edc2-4c6a-a496-c60b9438fab5.png)

## Vulnerability Priority Rating (VPR)

The VPR framework is much more modern framework in vulnerability management - developed by Tenable, an industry solution provider for vulnerability management. This framework is considered to be risk-driven; meaning that vulnerabilities are given a score with a heavy focus on the risk a vulnerability poses to the organisation itself, rather than factors such as impact (like with CVSS).

Unlike CVSS, VPR scoring takes into account the relevancy of a vulnerability. For example, no risk is considered regarding a vulnerability if that vulnerability does not apply to the organization (ie. they do not use the software that is vulnerable). VPR is also considerably dynamic in its scoring, where the risk that a vulnerability may pose can change almost daily as it ages. 

VPR uses a similar socring range as CVSS, which I have also put into the table below. However, two notable differences are that VPR does not have "None/Informational" category because VPR uses different scoring method, the same vulnerability will have a different score using VPR than when using CVSS. 

![image](https://user-images.githubusercontent.com/79100627/173859356-050df4b0-4c36-40db-a11f-4ba63a430b50.png)

![image](https://user-images.githubusercontent.com/79100627/173859410-cb9d85e9-3de8-4546-b6a9-899841ead25d.png)

## Vulnerability Databases 

Throughout your journey in cybersecurity, you will often come across a magnitude of different applications and services. For example, a CMS whilst they all have the same purpose, often have very different designs and behaviours (and, in turn, potentially different vulnerabilities). 

Thankfully for us,there are resources on the internet that keep track of vulnerabilities for all sorts of software, operating systems and more! This room will showcase two databases that we can use to look up existing vulnerabilities for applications discovered in our infosec journey, specifically the following websites:

1. NVD (National Vulnerability Database) 
2. Exploit - DB 

![image](https://user-images.githubusercontent.com/79100627/173862704-a1860db9-14fc-4993-bd60-5041ed640bfe.png)

## NVD - National Vulnerability Database

The National Vulnerability Database is a website that lists all publically categorised vulnerabilities. In Cybersecurity, vulnerabilities are classified under "Common Vulnerabilities and Exposures" (Or CVE for short).

These CVEs have the formattting of ```CVE-YEAR-IDNUMBER```. For example the vulnerability that the famous malware WannaCry used was ```CVE-2017-0144```

NVD allows you to see all the CVEs that have been confirmed, using filteres by category and month of submission. For example, it is three days into August; There have already been 223 new CVEs submitted to this database. 

![image](https://user-images.githubusercontent.com/79100627/173863976-ea7ad7fe-6da1-4877-a86e-b87fd0bc2062.png)

While this website hleps keep track of new vulnerabilities, It is not great when searching for vulnerabilities for a specific application or scenario 

## Exploit-DB

Exploit DB is a resource that we, as hacker, will find much more helpful during an ssessment. Exploit DB retains exploits for software and applications stored under the name, author and version of the software or application.

We can use Exploit-DB to look for snippets of code (known as Proof of Concepts) that are used to exploit a specific vulnerability
![image](https://user-images.githubusercontent.com/79100627/173864407-8d9d1e9b-4abd-4c9f-8d98-f78cddb0bd49.png)

## An Example of Finding Vulnerability 

In this task, I'm going to demonstrate the process of finding one minor vulnerability, coupled with some research of the vulnerability databases leading to a much more valuable vulnerability and exploit ultimately. Throughout an assessment, you will often combine multiple vulnerabilities to get results. For example, in this task, we will leverage the "Version Disclosure" Vulnerability to find out the version of an application. With this version, we can then use Exploit-DB to search for any exploits that work with that specific version.

Applications and software usually have a version number. This information is usually left with good intentions; for example, the author can support multiple versions of software and the likes

For example in the screenshot below we can see that the name and version number of the application "Apache Tomcat 9.0.17"

![image](https://user-images.githubusercontent.com/79100627/173865443-74bf9f04-3c41-4c11-8351-34d6ecff60e5.png)

With this information in hand, let use the search filter on Exploit DB to look for any exploits that may apply to "Apache Tomcat 9.0.17" 

![image](https://user-images.githubusercontent.com/79100627/173865593-168b68af-15b9-42ff-b778-1c2bf4e12374.png)

## Automated Vs. Manual Vulnerability Research 

There is a myraid of tools and services available in cybersecurity for vulnerability scanning. Ranging from being commercial (and footing a heavy bill) to open source and free, vulnerability scanners are convenient means of quickly canvassing an application for flaws. 

For example, the vulnerability scanner Nessus has both a free (Community) edition and commercial. The commercial version costing thousands of pounds for a year's license will likely be used in organisations providing penetration testing services or audits. If you'd like to know more about Nessus, check out the TryHackMe room dedicated to it. 

I have detailed some of the advantages and disadvantages of using a vulnerability scanner in the table below: 

![image](https://user-images.githubusercontent.com/79100627/174146231-fe49e191-166b-4ad2-b2d9-43ee9d1d418d.png)

Frameworks such as Metasploit often have vulnerability scanners for some modules; this is something you will come onto learn about in a further module in this pathway.

Manual  scanning for vulnerabilities is often the weapon of choice by a penetration tester when testing individual applications or programs. In fact, manaual scanning will invovle searching for the same vulnerabilities and uses similar techniques as automated scanning. 

Ultimately, both tehniques involve testing an application or program for vulnerabilities. These vulenrabilities include: 

![image](https://user-images.githubusercontent.com/79100627/174149561-687eea17-e60c-429f-9de3-0291f57e496f.png)

## Finding Manual Exploits 

### Rapid7

Much like other services such as Exploit DB and NVE, Rapid7 is a vulnerability research database. The only difference being that this database also acts as an exploit database. Using this service, you can filter by type of vulnerability. (I.e. application and operating system). 

Additionally, the database contains instruction for exploiting applications using the popular Metasploit tool. For example, this entry on Rapid7 is for "Wordpress Plugin SP Project & Document", where w can see instructions on how to use an exploit module to abuse this vulnerability. 

![image](https://user-images.githubusercontent.com/79100627/174150105-bae6526c-2df8-45c6-9ef5-3f8a04f4a7a4.png)

### Searchsploit 

Searcsploit is a tool that is available on popular pentesting distributions such as Kali Linux. This tool is an offline copy of Exploit-DB, containing copies of exploits on your system. 

You are able to search searchsploit by application name and/or vulnerability type.

![image](https://user-images.githubusercontent.com/79100627/174150504-bcbeb6fe-16f1-4841-99f4-bc39bb55dd40.png)

## Example Vulnerability Search 

We have a website called CMNatic Bookstore 

![image](https://user-images.githubusercontent.com/79100627/174153057-d0a7b62d-15ea-4331-8133-1b4e827f8a34.png)

Look for the vulnerability by using ```searchsploit online book store```

![image](https://user-images.githubusercontent.com/79100627/174153229-2309c8b5-09f8-4c60-9ae0-8e2e2d0ffba7.png)

We have a  ```Unauthenticated Remote Code Execution``` 
copy the exploit ```searchsploit -m php/webapps.47887.py```

![image](https://user-images.githubusercontent.com/79100627/174153457-f32edef9-266c-425b-90f5-74da6d86cf45.png)

Run the exploit 

![image](https://user-images.githubusercontent.com/79100627/174153626-2e98f6e8-5ec0-410c-ac9f-98f379d818a3.png)



